<style>
.from { padding: 2%; border: thin outset black; border-radius: 10px; }
.icon { padding: 2%; }
.img { max-width: 100vw; }
.msg {}
</style>
<h1>van <%= @id %><button class="material-icons r" id="tog">menu</button></h1>
<div id="ui">
<img src="/ui.png">
</div>
<div id="msgs" style="display:none;"></div>
<script>
$(function() {                                                                       
    var ws = new WebSocket("ws://localhost/");                                     
    ws.onopen = function(e) { ws.send(JSON.stringify(e)); };                             
    ws.onmessage = function(e) {                                                    
        var j = JSON.parse(e.data);
	if (j.msg) {
	    var x = "<" + j.container + ">";
	    x += "<span class='material-icons icon'>" + j.icon + "</span><span class='from' ";
	    x += "style='backgroumd-color: " + j.color + "'>";
	    x += j.from + "</span>";
	    if (j.img) {
		x += "<div class='img'>";
		x += "<img src='";
		x += j.img
		x += "'>";
		x += "</div>";
	    }
	    x += "<span class='msg'>" + j.msg + "</span>";
	    x += "</" + j.container + ">";
	    $("#msgs").prepend(x);
        }
        console.log("WS:", e);
    };
    $("#tog").on('click', function(e) { 
	e.preventDefault(); 
	$("#ui").toggle(); 
	$("#msgs").toggle(); 
    });
});
</script>
